<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documenta√ß√£o - Query Clipboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        header {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        nav {
            background: #263238;
            padding: 20px 40px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background 0.3s;
        }

        nav a:hover {
            background: rgba(255,255,255,0.1);
        }

        .content {
            padding: 40px;
        }

        section {
            margin-bottom: 60px;
        }

        h2 {
            color: #1976D2;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #1976D2;
        }

        h3 {
            color: #1565C0;
            font-size: 1.5em;
            margin: 30px 0 15px 0;
        }

        h4 {
            color: #424242;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }

        pre {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #1976D2;
        }

        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        .highlight-box {
            background: #E3F2FD;
            border-left: 4px solid #2196F3;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #FFF3E0;
            border-left: 4px solid #FF9800;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #E8F5E9;
            border-left: 4px solid #4CAF50;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .error-box {
            background: #FFEBEE;
            border-left: 4px solid #F44336;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th {
            background: #1976D2;
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .diagram {
            background: #fafafa;
            border: 2px solid #e0e0e0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: monospace;
            overflow-x: auto;
        }

        .file-tree {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
            line-height: 1.8;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 0 5px;
        }

        .badge-info { background: #2196F3; color: white; }
        .badge-success { background: #4CAF50; color: white; }
        .badge-warning { background: #FF9800; color: white; }
        .badge-error { background: #F44336; color: white; }

        footer {
            background: #263238;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 60px;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #1976D2;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .back-to-top:hover {
            background: #1565C0;
            transform: translateY(-5px);
        }

        @media print {
            nav, .back-to-top { display: none; }
            .container { box-shadow: none; }
            section { page-break-inside: avoid; }
        }

        @media (max-width: 768px) {
            .content { padding: 20px; }
            header { padding: 20px; }
            h2 { font-size: 1.5em; }
            nav ul { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Query Clipboard</h1>
            <p>Documenta√ß√£o T√©cnica Completa</p>
        </header>

        <nav>
            <ul>
                <li><a href="#visao-geral">Vis√£o Geral</a></li>
                <li><a href="#arquitetura">Arquitetura</a></li>
                <li><a href="#estrutura">Estrutura</a></li>
                <li><a href="#modelos">Modelos</a></li>
                <li><a href="#servicos">Servi√ßos</a></li>
                <li><a href="#interface">Interface</a></li>
                <li><a href="#fluxo">Fluxo</a></li>
                <li><a href="#atalho">Atalho Global</a></li>
                <li><a href="#armazenamento">Armazenamento</a></li>
                <li><a href="#manutencao">Manuten√ß√£o</a></li>
                <li><a href="#evolucao">Evolu√ß√£o</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
            </ul>
        </nav>

        <div class="content">
            <!-- VIS√ÉO GERAL -->
            <section id="visao-geral">
                <h2>üéØ Vis√£o Geral</h2>
                
                <h3>O que √©?</h3>
                <p>O <strong>Query Clipboard</strong> √© uma aplica√ß√£o desktop Windows (WPF) que permite:</p>
                <ul>
                    <li>Armazenar queries SQL usadas frequentemente</li>
                    <li>Acessar rapidamente atrav√©s de um atalho global (Ctrl+Alt+Q)</li>
                    <li>Copiar queries para o clipboard com um clique</li>
                    <li>Organizar queries por categorias</li>
                    <li>Buscar queries por nome, conte√∫do ou categoria</li>
                    <li>Escolher entre armazenamento JSON (local) ou SQL Server</li>
                </ul>

                <h3>Tecnologias Utilizadas</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tecnologia</th>
                            <th>Vers√£o</th>
                            <th>Prop√≥sito</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>.NET</td>
                            <td>8.0</td>
                            <td>Framework principal</td>
                        </tr>
                        <tr>
                            <td>WPF</td>
                            <td>-</td>
                            <td>Interface gr√°fica</td>
                        </tr>
                        <tr>
                            <td>XAML</td>
                            <td>-</td>
                            <td>Linguagem de marca√ß√£o para UI</td>
                        </tr>
                        <tr>
                            <td>C#</td>
                            <td>12.0</td>
                            <td>Linguagem de programa√ß√£o</td>
                        </tr>
                        <tr>
                            <td>Newtonsoft.Json</td>
                            <td>13.0.3</td>
                            <td>Serializa√ß√£o JSON</td>
                        </tr>
                        <tr>
                            <td>Microsoft.Data.SqlClient</td>
                            <td>5.1.5</td>
                            <td>Conex√£o com SQL Server</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- ARQUITETURA -->
            <section id="arquitetura">
                <h2>üèóÔ∏è Arquitetura do Sistema</h2>

                <h3>Padr√£o Arquitetural</h3>
                <p>O sistema utiliza uma <strong>arquitetura em camadas</strong> simples:</p>

                <div class="diagram">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      APRESENTA√á√ÉO (UI)              ‚îÇ
‚îÇ  MainWindow, QueryEditor,           ‚îÇ
‚îÇ      SettingsWindow                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ       SERVI√áOS (L√ìGICA)             ‚îÇ
‚îÇ QueryRepository, HotkeyManager,     ‚îÇ
‚îÇ      SettingsService                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ      MODELOS (DADOS)                ‚îÇ
‚îÇ QueryItem, Category, AppSettings    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   ARMAZENAMENTO (PERSIST√äNCIA)      ‚îÇ
‚îÇ    JSON Files / SQL Server          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                </div>

                <h3>Princ√≠pios Aplicados</h3>
                <div class="highlight-box">
                    <ul>
                        <li><strong>Separation of Concerns</strong> - Cada camada tem responsabilidade √∫nica</li>
                        <li><strong>Repository Pattern</strong> - Abstra√ß√£o do acesso a dados via interface</li>
                        <li><strong>Strategy Pattern</strong> - Troca entre JSON e SQL Server via interface comum</li>
                    </ul>
                </div>
            </section>

            <!-- ESTRUTURA DE PASTAS -->
            <section id="estrutura">
                <h2>üìÅ Estrutura de Pastas</h2>

                <div class="file-tree">
QueryClipboard/
‚îÇ
‚îú‚îÄ‚îÄ QueryClipboard.sln              # Solution do Visual Studio
‚îÇ
‚îî‚îÄ‚îÄ QueryClipboard/                 # Projeto principal
    ‚îÇ
    ‚îú‚îÄ‚îÄ Models/                     # Modelos de dados
    ‚îÇ   ‚îî‚îÄ‚îÄ Models.cs              # QueryItem, Category, AppSettings
    ‚îÇ
    ‚îú‚îÄ‚îÄ Services/                   # L√≥gica de neg√≥cio
    ‚îÇ   ‚îú‚îÄ‚îÄ IQueryRepository.cs    # Interface do reposit√≥rio
    ‚îÇ   ‚îú‚îÄ‚îÄ JsonQueryRepository.cs # Implementa√ß√£o JSON
    ‚îÇ   ‚îú‚îÄ‚îÄ SqlServerQueryRepository.cs # Implementa√ß√£o SQL Server
    ‚îÇ   ‚îú‚îÄ‚îÄ HotkeyManager.cs       # Gerenciador de atalhos globais
    ‚îÇ   ‚îî‚îÄ‚îÄ SettingsService.cs     # Gerenciador de configura√ß√µes
    ‚îÇ
    ‚îú‚îÄ‚îÄ Views/                      # Janelas da aplica√ß√£o
    ‚îÇ   ‚îú‚îÄ‚îÄ QueryEditorWindow.xaml(.cs)  # Editor de queries
    ‚îÇ   ‚îî‚îÄ‚îÄ SettingsWindow.xaml(.cs)     # Tela de configura√ß√µes
    ‚îÇ
    ‚îú‚îÄ‚îÄ MainWindow.xaml(.cs)        # Janela principal (popup)
    ‚îú‚îÄ‚îÄ App.xaml(.cs)              # Configura√ß√£o da aplica√ß√£o
    ‚îî‚îÄ‚îÄ QueryClipboard.csproj      # Arquivo do projeto
                </div>
            </section>

            <!-- MODELOS DE DADOS -->
            <section id="modelos">
                <h2>üìä Modelos de Dados</h2>

                <h3>1. QueryItem</h3>
                <p>Representa uma query SQL armazenada.</p>

                <pre><code>public class QueryItem
{
    public Guid Id { get; set; }              // ID √∫nico
    public string Name { get; set; }          // Nome da query
    public string SqlQuery { get; set; }      // C√≥digo SQL
    public string Category { get; set; }      // Categoria
    public string Description { get; set; }   // Descri√ß√£o opcional
    public DateTime CreatedAt { get; set; }   // Data de cria√ß√£o
    public DateTime LastUsed { get; set; }    // √öltima vez usada
    public int UsageCount { get; set; }       // Quantas vezes foi usada
}</code></pre>

                <div class="highlight-box">
                    <strong>Onde √© usado:</strong>
                    <ul>
                        <li>Exibido nos cards da MainWindow</li>
                        <li>Editado no QueryEditorWindow</li>
                        <li>Persistido no JSON ou SQL Server</li>
                    </ul>
                </div>

                <h3>2. Category</h3>
                <p>Representa uma categoria de queries.</p>

                <pre><code>public class Category
{
    public string Name { get; set; }   // Nome da categoria (ex: "DBA")
    public string Color { get; set; }  // Cor em hexadecimal (ex: "#2196F3")
}</code></pre>

                <h3>3. AppSettings</h3>
                <p>Configura√ß√µes globais da aplica√ß√£o.</p>

                <pre><code>public class AppSettings
{
    public string HotkeyModifier { get; set; }     // Ex: "Control+Alt"
    public string HotkeyKey { get; set; }          // Ex: "Q"
    public StorageMode StorageMode { get; set; }   // Json ou SqlServer
    public string? ConnectionString { get; set; }  // Connection string SQL
    public List&lt;Category&gt; Categories { get; set; } // Lista de categorias
}

public enum StorageMode
{
    Json,      // Armazena em arquivo JSON local
    SqlServer  // Armazena no SQL Server
}</code></pre>

                <div class="success-box">
                    <strong>Localiza√ß√£o do arquivo:</strong><br>
                    <code>%APPDATA%\QueryClipboard\settings.json</code>
                </div>
            </section>

            <!-- SERVI√áOS -->
            <section id="servicos">
                <h2>üîß Servi√ßos</h2>

                <h3>1. IQueryRepository (Interface)</h3>
                <p><strong>Localiza√ß√£o:</strong> <code>Services/IQueryRepository.cs</code></p>
                <p><strong>Responsabilidade:</strong> Define o contrato para acesso aos dados de queries.</p>

                <pre><code>public interface IQueryRepository
{
    Task&lt;List&lt;QueryItem&gt;&gt; GetAllQueriesAsync();
    Task&lt;QueryItem?&gt; GetQueryByIdAsync(Guid id);
    Task&lt;List&lt;QueryItem&gt;&gt; GetQueriesByCategoryAsync(string category);
    Task AddQueryAsync(QueryItem query);
    Task UpdateQueryAsync(QueryItem query);
    Task DeleteQueryAsync(Guid id);
    Task&lt;List&lt;QueryItem&gt;&gt; SearchQueriesAsync(string searchTerm);
    Task IncrementUsageAsync(Guid id);
}</code></pre>

                <div class="highlight-box">
                    <strong>üí° Por que existe:</strong> Permite trocar entre JSON e SQL Server sem mudar o c√≥digo da UI.
                </div>

                <h3>2. JsonQueryRepository</h3>
                <p><strong>Localiza√ß√£o:</strong> <code>Services/JsonQueryRepository.cs</code></p>
                <p><strong>Responsabilidade:</strong> Implementa armazenamento em arquivo JSON local.</p>

                <h4>Arquivo de dados:</h4>
                <pre><code>%APPDATA%\QueryClipboard\queries.json</code></pre>

                <h4>Como funciona:</h4>
                <ol>
                    <li>No construtor, carrega queries do arquivo JSON</li>
                    <li>Se o arquivo n√£o existe, cria queries de exemplo</li>
                    <li>Mant√©m as queries em mem√≥ria (<code>List&lt;QueryItem&gt;</code>)</li>
                    <li>A cada opera√ß√£o (Add, Update, Delete), salva tudo de volta no JSON</li>
                </ol>

                <table>
                    <thead>
                        <tr>
                            <th>Vantagens</th>
                            <th>Desvantagens</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>‚úÖ Simples e r√°pido</td>
                            <td>‚ùå N√£o compartilha entre m√°quinas</td>
                        </tr>
                        <tr>
                            <td>‚úÖ N√£o precisa de banco de dados</td>
                            <td>‚ùå Pode ter problemas com acesso concorrente</td>
                        </tr>
                        <tr>
                            <td>‚úÖ F√°cil fazer backup (s√≥ copiar o arquivo)</td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>

                <h3>3. SqlServerQueryRepository</h3>
                <p><strong>Localiza√ß√£o:</strong> <code>Services/SqlServerQueryRepository.cs</code></p>
                <p><strong>Responsabilidade:</strong> Implementa armazenamento no SQL Server.</p>

                <h4>Estrutura da tabela:</h4>
                <pre><code>CREATE TABLE Queries (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Name NVARCHAR(200) NOT NULL,
    SqlQuery NVARCHAR(MAX) NOT NULL,
    Category NVARCHAR(100) NOT NULL,
    Description NVARCHAR(500),
    CreatedAt DATETIME2 DEFAULT GETDATE(),
    LastUsed DATETIME2 DEFAULT GETDATE(),
    UsageCount INT DEFAULT 0
);

-- √çndices para performance
CREATE INDEX IX_Queries_Category ON Queries(Category);
CREATE INDEX IX_Queries_LastUsed ON Queries(LastUsed DESC);</code></pre>

                <h3>4. HotkeyManager</h3>
                <p><strong>Localiza√ß√£o:</strong> <code>Services/HotkeyManager.cs</code></p>
                <p><strong>Responsabilidade:</strong> Registra e gerencia o atalho global do Windows.</p>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Importante:</strong> O atalho funciona mesmo quando a janela est√° escondida!
                </div>

                <h4>Modificadores dispon√≠veis:</h4>
                <ul>
                    <li><code>MOD_CONTROL</code> (0x0002) = Ctrl</li>
                    <li><code>MOD_ALT</code> (0x0001) = Alt</li>
                    <li><code>MOD_SHIFT</code> (0x0004) = Shift</li>
                    <li><code>MOD_WIN</code> (0x0008) = Windows Key</li>
                </ul>

                <h3>5. SettingsService</h3>
                <p><strong>Localiza√ß√£o:</strong> <code>Services/SettingsService.cs</code></p>
                <p><strong>Responsabilidade:</strong> Carrega e salva configura√ß√µes da aplica√ß√£o.</p>
            </section>

            <!-- INTERFACE -->
            <section id="interface">
                <h2>üñ•Ô∏è Interface (Views)</h2>

                <h3>1. MainWindow (Popup Principal)</h3>
                <p><strong>Arquivos:</strong> <code>MainWindow.xaml</code> e <code>MainWindow.xaml.cs</code></p>

                <h4>Caracter√≠sticas:</h4>
                <ul>
                    <li><code>WindowStyle="None"</code> - Sem borda do Windows</li>
                    <li><code>AllowsTransparency="True"</code> - Permite cantos arredondados</li>
                    <li><code>Topmost="True"</code> - Sempre fica por cima</li>
                    <li><code>ShowInTaskbar="False"</code> - N√£o aparece na barra de tarefas</li>
                </ul>

                <h4>Componentes principais:</h4>
                <div class="highlight-box">
                    <ul>
                        <li><strong>Header (Topo azul)</strong> - Logo, t√≠tulo, bot√µes de configura√ß√µes e fechar</li>
                        <li><strong>Busca</strong> - TextBox com filtro em tempo real</li>
                        <li><strong>Categorias</strong> - Bot√µes coloridos gerados dinamicamente</li>
                        <li><strong>Lista de Queries</strong> - Cards com informa√ß√µes completas</li>
                        <li><strong>Footer</strong> - Contador de queries e bot√£o de nova query</li>
                    </ul>
                </div>

                <h4>M√©todos importantes:</h4>
                <pre><code>// Mostra o popup
private void ShowPopup()

// Carrega queries do reposit√≥rio
private async void LoadQueries()

// Cria um card visual para cada query
private Border CreateQueryCard(QueryItem query)

// Copia query pro clipboard e esconde janela
private async Task CopyQueryToClipboard(QueryItem query)

// Filtra queries pela busca
private async void SearchTextBox_TextChanged(...)

// Filtra por categoria
private void FilterByCategory(string? category)</code></pre>

                <h3>2. QueryEditorWindow</h3>
                <p><strong>Arquivos:</strong> <code>Views/QueryEditorWindow.xaml(.cs)</code></p>
                <p><strong>Responsabilidade:</strong> Janela modal para criar/editar queries.</p>

                <h4>Campos:</h4>
                <ul>
                    <li><strong>Nome</strong> - TextBox</li>
                    <li><strong>Categoria</strong> - ComboBox edit√°vel</li>
                    <li><strong>Descri√ß√£o</strong> - TextBox opcional</li>
                    <li><strong>SQL Query</strong> - TextBox multilinha com fonte Consolas</li>
                </ul>

                <h4>Valida√ß√µes:</h4>
                <div class="error-box">
                    <ul>
                        <li>Nome obrigat√≥rio</li>
                        <li>Categoria obrigat√≥ria</li>
                        <li>Query SQL obrigat√≥ria</li>
                    </ul>
                </div>

                <h3>3. SettingsWindow</h3>
                <p><strong>Arquivos:</strong> <code>Views/SettingsWindow.xaml(.cs)</code></p>
                <p><strong>Responsabilidade:</strong> Tela de configura√ß√µes do sistema.</p>

                <h4>Se√ß√µes:</h4>
                <ol>
                    <li><strong>Modo de Armazenamento</strong> - JSON ou SQL Server</li>
                    <li><strong>Atalho de Teclado</strong> - Mostra o atalho atual</li>
                    <li><strong>Categorias</strong> - Gerenciamento de categorias</li>
                </ol>
            </section>

            <!-- FLUXO DE FUNCIONAMENTO -->
            <section id="fluxo">
                <h2>üîÑ Fluxo de Funcionamento</h2>

                <h3>Fluxo 1: Inicializa√ß√£o do App</h3>
                <div class="diagram">
1. App.xaml.cs inicia
   ‚Üì
2. MainWindow √© criada
   ‚Üì
3. No construtor:
   - SettingsService carrega configura√ß√µes
   - Cria reposit√≥rio baseado no StorageMode
   - Cria HotkeyManager
   ‚Üì
4. Evento Window_Loaded:
   - Registra atalho Ctrl+Alt+Q no Windows
   - Mostra MessageBox de boas-vindas
   - Mostra o popup
   ‚Üì
5. LoadCategories() - Cria bot√µes de categoria
   ‚Üì
6. LoadQueries() - Busca queries e cria cards
                </div>

                <h3>Fluxo 2: Usu√°rio Pressiona Ctrl+Alt+Q</h3>
                <div class="diagram">
1. Windows intercepta o atalho
   ‚Üì
2. Windows envia mensagem WM_HOTKEY
   ‚Üì
3. HotkeyManager.HwndHook recebe a mensagem
   ‚Üì
4. HotkeyManager dispara evento HotkeyPressed
   ‚Üì
5. MainWindow.HotkeyManager_HotkeyPressed
   ‚Üì
6. Verifica: janela est√° vis√≠vel?
   - Se SIM: Esconde
   - Se N√ÉO: ShowPopup()
                </div>

                <h3>Fluxo 3: Usu√°rio Clica em uma Query</h3>
                <div class="diagram">
1. Evento MouseLeftButtonUp no card
   ‚Üì
2. CopyQueryToClipboard(query) √© chamado
   ‚Üì
3. Clipboard.SetText(query.SqlQuery)
   ‚Üì
4. IncrementUsageAsync(query.Id)
   ‚Üì
5. Atualiza StatusTextBlock
   ‚Üì
6. await Task.Delay(500)
   ‚Üì
7. this.Hide() - Esconde o popup
                </div>

                <h3>Fluxo 4: Criar Nova Query</h3>
                <div class="diagram">
1. Clica "+ Nova Query"
   ‚Üì
2. new QueryEditorWindow(_repository)
   ‚Üì
3. dialog.ShowDialog() - Modal abre
   ‚Üì
4. Usu√°rio preenche e clica "Salvar"
   ‚Üì
5. Valida√ß√£o dos campos
   ‚Üì
6. var newQuery = new QueryItem { ... }
   ‚Üì
7. await _repository.AddQueryAsync(newQuery)
   ‚Üì
8. DialogResult = true; Close()
   ‚Üì
9. MainWindow.LoadQueries() recarrega
                </div>
            </section>

            <!-- ATALHO GLOBAL -->
            <section id="atalho">
                <h2>üîê Como Funciona o Atalho Global</h2>

                <h3>Conceito</h3>
                <p>Um <strong>atalho global</strong> funciona em <strong>qualquer lugar do Windows</strong>, mesmo que a aplica√ß√£o n√£o tenha foco.</p>

                <h3>Implementa√ß√£o</h3>

                <h4>1. Registro do Atalho</h4>
                <pre><code>[DllImport("user32.dll")]
private static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, uint vk);

// No c√≥digo:
RegisterHotKey(windowHandle, HOTKEY_ID, MOD_CONTROL | MOD_ALT, VK_Q);</code></pre>

                <h4>Par√¢metros:</h4>
                <ul>
                    <li><code>windowHandle</code> - Handle da MainWindow</li>
                    <li><code>HOTKEY_ID</code> - ID √∫nico (9000)</li>
                    <li><code>fsModifiers</code> - Modificadores (Ctrl + Alt)</li>
                    <li><code>vk</code> - Virtual Key Code da tecla (Q)</li>
                </ul>

                <h4>2. Intercepta√ß√£o da Mensagem</h4>
                <pre><code>private IntPtr HwndHook(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
{
    const int WM_HOTKEY = 0x0312;
    
    if (msg == WM_HOTKEY && wParam.ToInt32() == HOTKEY_ID)
    {
        HotkeyPressed?.Invoke(this, EventArgs.Empty);
        handled = true;
    }
    
    return IntPtr.Zero;
}</code></pre>

                <h4>3. Limpeza</h4>
                <pre><code>[DllImport("user32.dll")]
private static extern bool UnregisterHotKey(IntPtr hWnd, int id);

protected override void OnClosed(EventArgs e)
{
    _hotkeyManager.UnregisterHotkey();
    base.OnClosed(e);
}</code></pre>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Importante:</strong> Sempre desregistrar o atalho ao fechar, sen√£o ele fica "preso" no Windows!
                </div>
            </section>

            <!-- ARMAZENAMENTO -->
            <section id="armazenamento">
                <h2>üíæ Armazenamento de Dados</h2>

                <h3>Localiza√ß√£o dos Arquivos</h3>
                <div class="success-box">
                    <strong>Todos os dados ficam em:</strong><br>
                    <code>C:\Users\[SeuUsuario]\AppData\Roaming\QueryClipboard\</code>
                    <ul>
                        <li><code>settings.json</code> - Configura√ß√µes do app</li>
                        <li><code>queries.json</code> - Queries armazenadas (apenas no modo JSON)</li>
                    </ul>
                </div>

                <h3>Modo JSON</h3>
                <h4>Formato do arquivo queries.json:</h4>
                <pre><code>[
  {
    "Id": "550e8400-e29b-41d4-a716-446655440000",
    "Name": "Buscar Usu√°rios Ativos",
    "SqlQuery": "SELECT * FROM Usuarios WHERE Ativo = 1",
    "Category": "DBA",
    "Description": "Lista todos os usu√°rios ativos",
    "CreatedAt": "2025-01-15T10:30:00",
    "LastUsed": "2025-01-15T14:20:00",
    "UsageCount": 5
  }
]</code></pre>

                <h4>Como funciona:</h4>
                <ol>
                    <li>No construtor: carrega todo o arquivo JSON na mem√≥ria</li>
                    <li>Desserializa para <code>List&lt;QueryItem&gt;</code></li>
                    <li>Opera√ß√µes modificam a lista em mem√≥ria</li>
                    <li>Serializa toda a lista de volta pro JSON</li>
                    <li>Salva o arquivo</li>
                </ol>

                <div class="success-box">
                    <strong>‚úÖ Backup:</strong> Basta copiar o arquivo <code>queries.json</code>!
                </div>

                <h3>Modo SQL Server</h3>
                <h4>Script de cria√ß√£o da tabela:</h4>
                <pre><code>CREATE TABLE Queries (
    Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
    Name NVARCHAR(200) NOT NULL,
    SqlQuery NVARCHAR(MAX) NOT NULL,
    Category NVARCHAR(100) NOT NULL,
    Description NVARCHAR(500),
    CreatedAt DATETIME2 DEFAULT GETDATE(),
    LastUsed DATETIME2 DEFAULT GETDATE(),
    UsageCount INT DEFAULT 0
);

-- √çndices para performance
CREATE INDEX IX_Queries_Category ON Queries(Category);
CREATE INDEX IX_Queries_LastUsed ON Queries(LastUsed DESC);</code></pre>

                <h4>Connection String exemplo:</h4>
                <pre><code>Server=localhost;Database=QueryClipboard;Integrated Security=True;TrustServerCertificate=True;</code></pre>
            </section>

            <!-- MANUTEN√á√ÉO -->
            <section id="manutencao">
                <h2>üîß Guia de Manuten√ß√£o</h2>

                <h3>Alterando o Atalho Global</h3>
                <p><strong>Arquivo:</strong> <code>MainWindow.xaml.cs</code></p>
                <p><strong>Localiza√ß√£o:</strong> M√©todo <code>Window_Loaded</code></p>

                <pre><code>// ATUAL: Ctrl+Alt+Q
_hotkeyManager.RegisterHotkey(windowHandle, 
    ModifierKeys.Control | ModifierKeys.Alt, Key.Q);

// EXEMPLO: Ctrl+Shift+C
_hotkeyManager.RegisterHotkey(windowHandle, 
    ModifierKeys.Control | ModifierKeys.Shift, Key.C);

// EXEMPLO: Windows+Q
_hotkeyManager.RegisterHotkey(windowHandle, 
    ModifierKeys.Windows, Key.Q);</code></pre>

                <h3>Adicionando Novo Campo em QueryItem</h3>

                <h4>1. Atualizar o Model:</h4>
                <pre><code>public class QueryItem
{
    // ... campos existentes ...
    public string Tags { get; set; } = string.Empty;  // NOVO
}</code></pre>

                <h4>2. Atualizar JsonQueryRepository:</h4>
                <p>N√£o precisa fazer nada! O JSON vai serializar automaticamente.</p>

                <h4>3. Atualizar SqlServerQueryRepository:</h4>
                <pre><code>-- Adicionar coluna na tabela
ALTER TABLE Queries ADD Tags NVARCHAR(500);

-- Atualizar queries SQL no c√≥digo
command.Parameters.AddWithValue("@Tags", query.Tags ?? string.Empty);</code></pre>

                <h3>Alterando Cores do Tema</h3>
                <p><strong>Arquivo:</strong> <code>MainWindow.xaml</code> e outros arquivos .xaml</p>

                <h4>Cores principais:</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Elemento</th>
                            <th>Cor</th>
                            <th>Uso</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Header</td>
                            <td><span class="badge badge-info">#1976D2</span></td>
                            <td>Topo azul</td>
                        </tr>
                        <tr>
                            <td>Bot√£o principal</td>
                            <td><span class="badge badge-info">#1976D2</span></td>
                            <td>Bot√µes de a√ß√£o</td>
                        </tr>
                        <tr>
                            <td>Bot√£o excluir</td>
                            <td><span class="badge badge-error">#F44336</span></td>
                            <td>Vermelho</td>
                        </tr>
                        <tr>
                            <td>Bot√£o editar</td>
                            <td><span class="badge badge-success">#4CAF50</span></td>
                            <td>Verde</td>
                        </tr>
                        <tr>
                            <td>Fundo claro</td>
                            <td>#F5F5F5</td>
                            <td>√Åreas secund√°rias</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- EVOLU√á√ÉO -->
            <section id="evolucao">
                <h2>üöÄ Guia de Evolu√ß√£o</h2>

                <h3>Funcionalidades Sugeridas</h3>

                <h4>1. Syntax Highlighting no Editor</h4>
                <div class="highlight-box">
                    <strong>Biblioteca:</strong> AvalonEdit
                    <pre><code>&lt;PackageReference Include="AvalonEdit" Version="6.3.0.90" /&gt;</code></pre>
                </div>

                <h4>2. Importar/Exportar Queries</h4>
                <pre><code>private async void ExportButton_Click(object sender, RoutedEventArgs e)
{
    var saveDialog = new Microsoft.Win32.SaveFileDialog
    {
        Filter = "JSON files (*.json)|*.json",
        DefaultExt = ".json"
    };
    
    if (saveDialog.ShowDialog() == true)
    {
        var queries = await _repository.GetAllQueriesAsync();
        var json = JsonConvert.SerializeObject(queries, Formatting.Indented);
        File.WriteAllText(saveDialog.FileName, json);
    }
}</code></pre>

                <h4>3. Sistema de Tags</h4>
                <pre><code>public class QueryItem
{
    // ... campos existentes ...
    public List&lt;string&gt; Tags { get; set; } = new();
}</code></pre>

                <h4>4. √çcone na System Tray</h4>
                <pre><code>private NotifyIcon? _notifyIcon;

public MainWindow()
{
    InitializeComponent();
    
    _notifyIcon = new NotifyIcon
    {
        Icon = SystemIcons.Application,
        Visible = true,
        Text = "Query Clipboard"
    };
    
    _notifyIcon.DoubleClick += (s, e) => ShowPopup();
}</code></pre>

                <h4>5. Dark Mode</h4>
                <p>Criar ResourceDictionaries separados para temas Light e Dark</p>

                <h4>6. Valida√ß√£o de SQL</h4>
                <div class="highlight-box">
                    <strong>Biblioteca:</strong> Microsoft.SqlServer.TransactSql.ScriptDom
                </div>

                <h4>7. Conectar Direto no Banco</h4>
                <p>Executar a query direto do app e mostrar resultados em DataGrid</p>

                <h4>8. Hist√≥rico de Uso</h4>
                <p>Criar nova tabela QueryHistory para rastrear todas as execu√ß√µes</p>
            </section>

            <!-- TROUBLESHOOTING -->
            <section id="troubleshooting">
                <h2>üêõ Troubleshooting</h2>

                <h3>Problema: App n√£o abre</h3>
                <div class="error-box">
                    <strong>Poss√≠veis causas:</strong>
                    <ul>
                        <li>.NET 8 n√£o instalado</li>
                        <li>Arquivo de configura√ß√£o corrompido</li>
                        <li>Problema com atalho</li>
                    </ul>
                </div>

                <h4>Solu√ß√£o:</h4>
                <pre><code>// Adicionar try-catch no App.xaml.cs
protected override void OnStartup(StartupEventArgs e)
{
    base.OnStartup(e);
    
    AppDomain.CurrentDomain.UnhandledException += (s, args) =>
    {
        var ex = (Exception)args.ExceptionObject;
        MessageBox.Show($"Erro fatal: {ex.Message}\n\n{ex.StackTrace}");
    };
}</code></pre>

                <h3>Problema: Atalho n√£o funciona</h3>
                <div class="warning-box">
                    <strong>Causa:</strong> Outro app j√° registrou Ctrl+Alt+Q
                </div>

                <h4>Solu√ß√£o:</h4>
                <pre><code>try
{
    _hotkeyManager.RegisterHotkey(windowHandle, modifiers, key);
}
catch (InvalidOperationException ex)
{
    var result = MessageBox.Show(
        "O atalho Ctrl+Alt+Q j√° est√° em uso. Deseja tentar Ctrl+Alt+W?",
        "Conflito de Atalho",
        MessageBoxButton.YesNo);
    
    if (result == MessageBoxResult.Yes)
    {
        _hotkeyManager.RegisterHotkey(windowHandle, modifiers, Key.W);
    }
}</code></pre>

                <h3>Problema: Queries n√£o salvam (JSON)</h3>
                <div class="error-box">
                    <strong>Causa:</strong> Permiss√µes na pasta AppData
                </div>

                <h4>Solu√ß√£o:</h4>
                <pre><code>try
{
    Directory.CreateDirectory(appDataPath);
    File.WriteAllText(_filePath, json);
}
catch (UnauthorizedAccessException)
{
    // Tentar pasta alternativa
    var tempPath = Path.Combine(Path.GetTempPath(), "QueryClipboard");
    Directory.CreateDirectory(tempPath);
    _filePath = Path.Combine(tempPath, "queries.json");
}</code></pre>

                <h3>Problema: N√£o conecta no SQL Server</h3>
                <div class="error-box">
                    <strong>Causa:</strong> Connection string errada ou SQL Server n√£o rodando
                </div>

                <h4>Diagn√≥stico:</h4>
                <pre><code>try
{
    using var connection = new SqlConnection(connectionString);
    await connection.OpenAsync();
    MessageBox.Show("Conex√£o OK!");
}
catch (SqlException ex)
{
    switch (ex.Number)
    {
        case 53:
        case 1231:
            MessageBox.Show("SQL Server n√£o encontrado.");
            break;
        case 18456:
            MessageBox.Show("Erro de autentica√ß√£o.");
            break;
        default:
            MessageBox.Show($"Erro SQL {ex.Number}: {ex.Message}");
            break;
    }
}</code></pre>
            </section>

            <!-- RECURSOS ADICIONAIS -->
            <section>
                <h2>üìö Recursos Adicionais</h2>

                <h3>Documenta√ß√£o Oficial</h3>
                <ul>
                    <li><a href="https://learn.microsoft.com/en-us/dotnet/desktop/wpf/" target="_blank">WPF Documentation</a></li>
                    <li><a href="https://learn.microsoft.com/en-us/dotnet/core/whats-new/dotnet-8" target="_blank">.NET 8 Documentation</a></li>
                    <li><a href="https://learn.microsoft.com/en-us/sql/connect/ado-net/microsoft-ado-net-sql-server" target="_blank">SQL Server Client</a></li>
                </ul>

                <h3>Bibliotecas √öteis</h3>
                <ul>
                    <li><strong>AvalonEdit</strong> - Editor de c√≥digo com syntax highlighting</li>
                    <li><strong>Extended WPF Toolkit</strong> - Controles WPF extras</li>
                    <li><strong>Hardcodet NotifyIcon</strong> - System tray icon melhorado</li>
                    <li><strong>MahApps.Metro</strong> - Temas modernos para WPF</li>
                </ul>

                <h3>Ferramentas</h3>
                <ul>
                    <li><strong>Snoop</strong> - Debugger visual para WPF</li>
                    <li><strong>XAML Styler</strong> - Formatador de XAML</li>
                    <li><strong>ResXManager</strong> - Gerenciador de recursos/localiza√ß√£o</li>
                </ul>
            </section>

            <!-- CONCLUS√ÉO -->
            <section>
                <h2>üéì Conclus√£o</h2>

                <div class="success-box">
                    <h3>Este sistema foi projetado para ser:</h3>
                    <ul>
                        <li>‚úÖ <strong>Simples</strong> - C√≥digo limpo e bem organizado</li>
                        <li>‚úÖ <strong>Extens√≠vel</strong> - F√°cil adicionar funcionalidades</li>
                        <li>‚úÖ <strong>Manuten√≠vel</strong> - Separa√ß√£o clara de responsabilidades</li>
                        <li>‚úÖ <strong>Test√°vel</strong> - Interfaces permitem testes unit√°rios</li>
                    </ul>
                </div>

                <h3>Padr√µes Aplicados</h3>
                <ul>
                    <li>Repository Pattern</li>
                    <li>Dependency Injection (manual)</li>
                    <li>Event-Driven Architecture (atalhos)</li>
                    <li>MVVM (parcial, pode evoluir)</li>
                </ul>

                <h3>Pr√≥ximos Passos Sugeridos</h3>
                <ol>
                    <li>Adicionar testes unit√°rios</li>
                    <li>Implementar MVVM completo</li>
                    <li>Criar instalador (WiX ou Inno Setup)</li>
                    <li>Publicar no GitHub</li>
                </ol>

                <div class="highlight-box" style="text-align: center; font-size: 1.2em; margin-top: 30px;">
                    <strong>Qualquer d√∫vida, consulte esta documenta√ß√£o ou o c√≥digo-fonte! üöÄ</strong>
                </div>
            </section>
        </div>

        <footer>
            <p><strong>Query Clipboard</strong> - Documenta√ß√£o T√©cnica Completa</p>
            <p>Vers√£o 1.0 | ¬© 2025 | Desenvolvido com ‚ù§Ô∏è em .NET 8 + WPF</p>
        </footer>
    </div>

    <a href="#" class="back-to-top">‚Üë</a>

    <script>
        // Smooth scroll para links √¢ncora
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Mostrar/esconder bot√£o voltar ao topo
        const backToTop = document.querySelector('.back-to-top');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTop.style.display = 'flex';
            } else {
                backToTop.style.display = 'none';
            }
        });
    </script>
</body>
</html>